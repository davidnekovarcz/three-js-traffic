<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Console Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            font-family: monospace;
        }
        #console {
            background: #000;
            border: 1px solid #333;
            padding: 10px;
            height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .log { color: #ccc; }
        .error { color: #f44336; }
        .warn { color: #ff9800; }
        .info { color: #2196f3; }
        .timestamp { color: #666; }
    </style>
</head>
<body>
    <!-- Required DOM elements -->
    <div id="score" style="display: none;">Press UP</div>
    <div id="controls" style="display: none;">
        <div id="buttons">
            <button id="accelerate"></button>
            <button id="decelerate"></button>
        </div>
        <div id="instructions"></div>
    </div>
    <div id="results" style="display: none;"></div>
    <div id="pause-dialog" style="display: none;"></div>
    
    <h1>Console Output</h1>
    <div id="console"></div>
    
    <button onclick="location.reload()">Reload</button>
    <button onclick="clearConsole()">Clear</button>
    
    <script>
        const consoleDiv = document.getElementById('console');
        const logs = [];
        
        function addLog(type, args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = Array.from(args).map(arg => {
                if (typeof arg === 'object') {
                    try {
                        return JSON.stringify(arg, null, 2);
                    } catch (e) {
                        return String(arg);
                    }
                }
                return String(arg);
            }).join(' ');
            
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
            consoleDiv.appendChild(logEntry);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
            
            logs.push({ type, timestamp, message });
        }
        
        function clearConsole() {
            consoleDiv.innerHTML = '';
            logs.length = 0;
        }
        
        // Override console methods
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn,
            info: console.info
        };
        
        console.log = function(...args) {
            originalConsole.log(...args);
            addLog('log', args);
        };
        
        console.error = function(...args) {
            originalConsole.error(...args);
            addLog('error', args);
        };
        
        console.warn = function(...args) {
            originalConsole.warn(...args);
            addLog('warn', args);
        };
        
        console.info = function(...args) {
            originalConsole.info(...args);
            addLog('info', args);
        };
        
        // Capture unhandled errors
        window.addEventListener('error', (event) => {
            addLog('error', [`Uncaught Error: ${event.message}`, `at ${event.filename}:${event.lineno}:${event.colno}`]);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            addLog('error', [`Unhandled Promise Rejection:`, event.reason]);
        });
    </script>
    
    <!-- Now load the game -->
    <script type="module">
        console.log('Starting game load test...');
        
        try {
            console.log('Importing main.js...');
            await import('/src/main.js');
            console.log('main.js imported successfully');
        } catch (error) {
            console.error('Failed to import main.js:', error);
            console.error('Stack:', error.stack);
        }
    </script>
</body>
</html>